<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2022-11-20 Sun 18:25 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Mithril.js</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Alex Nelson">
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=Spectral&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Merriweather" rel="stylesheet">
<div style="display: none"> \(
\newcommand\D{\mathrm{d}}
\newcommand\E{\mathrm{e}}
\newcommand\I{\mathrm{i}}
\newcommand\bigOh{\mathcal{O}}
\newcommand{\cat}[1]{\mathbf{#1}}
\newcommand\curl{\vec{\nabla}\times}
\newcommand{\CC}{\mathbb{C}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\ZZ}{\mathbb{Z}}
\)</div>
<link rel="stylesheet" type="text/css" href="../css/stylesheet.css" />
<script type="text/javascript">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="./index.html"> UP </a>
 |
 <a accesskey="H" href="../index.html"> HOME </a>
</div><div id="content">
<h1 class="title">Mithril.js</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#h-5b5ee42d-9166-4959-b75d-2b5d348581a8">1. "Design Tools"</a>
<ul>
<li><a href="#h-6afdd666-a0c7-4948-8821-df384cb19e75">1.1. SAM (State-Action-Model)</a>
<ul>
<li><a href="#h-bbe4f793-f7f2-4d05-9ec1-cddeae1d8a78">1.1.1. Example in Mithril.js</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h-81096b07-f043-42aa-91c4-fba28ee7e052">2. References</a></li>
</ul>
</div>
</div>

<div id="outline-container-h-5b5ee42d-9166-4959-b75d-2b5d348581a8" class="outline-2">
<h2 id="h-5b5ee42d-9166-4959-b75d-2b5d348581a8"><span class="section-number-2">1.</span> "Design Tools"</h2>
<div class="outline-text-2" id="text-h-5b5ee42d-9166-4959-b75d-2b5d348581a8">
<p>
I know React uses a <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93viewmodel">MVVM</a> architecture for its components. Mithril.js
uses MVC explicitly.
</p>
</div>

<div id="outline-container-h-6afdd666-a0c7-4948-8821-df384cb19e75" class="outline-3">
<h3 id="h-6afdd666-a0c7-4948-8821-df384cb19e75"><span class="section-number-3">1.1.</span> SAM (State-Action-Model)</h3>
<div class="outline-text-3" id="text-h-6afdd666-a0c7-4948-8821-df384cb19e75">
<p>
There is also the State-Action-Model architecture, which is the hot new
thing replacing MVC (and MVVM). Basically, as I understand it,
</p>

<ol class="org-ol">
<li>Actions compute proposals. Actions cannot mutate the properties of
the model.</li>
<li>The models accepts, partially accepts, or rejects the proposal. A
model should be a series of "acceptors" and "reactors".
<ul class="org-ul">
<li>Acceptors validate proposals and mutate the state accordingly</li>
<li>Reactors react to state mutations and are not involved in the
processing proposals</li>
</ul></li>
<li>Evaluate whether a next-action is needed</li>
<li>Compute the new state representation.</li>
</ol>

<p>
Assignments are not mutations, and mutations must be explicit.
</p>

<p>
The "programming step" is specified by <code>Action -&gt; Model -&gt; State</code>.
</p>

<ul class="org-ul">
<li>Actions are functions, with type signature <code>Action : Event -&gt; Proposal</code></li>
<li>Proposals are "proposals to mutate the property values of the Model"</li>
<li>The Model is an instance of a class (or closure) generally with a
single method that is used to receive proposals to mutate the property
values; when the mutation is complete, the model invokes the "State"
function, whose role is to compute the (control) state, which can also
be viewed as the state representation of the model.</li>
<li>The State function invokes the next-action predicate which computes
whether an action needs to be triggered in the current (new)
occurrence of a control state.</li>
</ul>

<p>
The idea is that <code>&lt;View params={Model} /&gt;</code> is no different than <code>View = f(Model)</code>.
Then the purpose of React (and friends) is to decompose the view into a
series of <b><b>pure</b></b> functions.
</p>

<p>
Now, in "traditional/orthodox MVC", it's entirely interactive (as
opposed to <i>reactive</i>). The action (<i>nee</i> Controller) would call an
update method on the model, then depending on success or failure would
determine how to update the view accordingly.
</p>

<p>
Reactive coding would have actions (controllers) pass values to the
model, regardless of the outcome. There is no "decide how to update the
model". A reactive MVC would look something like
</p>

<ul class="org-ul">
<li><code>View = f(Model.present(Action(data)))</code>
<ul class="org-ul">
<li>When an action is triggered, it computes a data set from a set of
inputs (e.g., user inputs) that is presented to the model, which then
decides if and how to update itself.</li>
<li>Once the update is complete, the view is rendered from the new model state.</li>
<li>The reactive loop is then closed.</li>
</ul></li>
</ul>

<p>
The SAM pattern boils down to the expresion:
</p>

<ul class="org-ul">
<li><code>View = State(view_model(Model.present(Action(data))), next_action_predicate(Model))</code>
<ul class="org-ul">
<li><code>Action</code>, <code>view_model</code>, and <code>next_action_predicate</code> must be pure functions</li>
<li><code>next_action_predicate</code> is a callback invoked once the state
representation has been created and on its way to be rendered to the user.</li>
</ul></li>
</ul>



<p>
References:
</p>

<ul class="org-ul">
<li><a href="https://dzone.com/articles/the-three-approximations-you-should-never-use-when">https://dzone.com/articles/the-three-approximations-you-should-never-use-when</a></li>
<li><a href="https://www.infoq.com/articles/no-more-mvc-frameworks/">https://www.infoq.com/articles/no-more-mvc-frameworks/</a></li>
<li><a href="https://sam.js.org/">https://sam.js.org/</a></li>
<li><a href="https://github.com/MithrilJS/mithril.js/issues/2495#issuecomment-1196762487">https://github.com/MithrilJS/mithril.js/issues/2495#issuecomment-1196762487</a></li>
<li><a href="https://meiosis.js.org/">https://meiosis.js.org/</a></li>
</ul>
</div>

<div id="outline-container-h-bbe4f793-f7f2-4d05-9ec1-cddeae1d8a78" class="outline-4">
<h4 id="h-bbe4f793-f7f2-4d05-9ec1-cddeae1d8a78"><span class="section-number-4">1.1.1.</span> Example in Mithril.js</h4>
<div class="outline-text-4" id="text-h-bbe4f793-f7f2-4d05-9ec1-cddeae1d8a78">
<p>
Let's examine the following "counter" example from <a href="https://github.com/MithrilJS/mithril.js/issues/2495#issuecomment-1196762487">foucist</a>:
</p>

<div class="org-src-container">
<pre class="src src-js"><span class="org-keyword">const</span> <span class="org-variable-name">State</span> = () =&gt; ({ count: 0 });

<span class="org-keyword">const</span> <span class="org-variable-name">Actions</span> = state =&gt; ({
  increment: () =&gt; state.count += 1,
  decrement: () =&gt; state.count -= 1
});

<span class="org-keyword">const</span> <span class="org-variable-name">state</span>   = State();
<span class="org-keyword">const</span> <span class="org-variable-name">actions</span> = Actions(state);

<span class="org-keyword">const</span> <span class="org-variable-name">Counter</span> = {
  view: ({ attrs: { state, actions } }) =&gt;
    m(<span class="org-string">'div'</span>,
      m(<span class="org-string">'h1'</span>, <span class="org-string">'Counter'</span>),
      m(<span class="org-string">'p'</span>, state.count),
      m(<span class="org-string">'button'</span>, { onclick: actions.increment }, <span class="org-string">'+'</span>),
      m(<span class="org-string">'button'</span>, { onclick: actions.decrement }, <span class="org-string">'-'</span>)
    )
};

m.mount(document.body, {
  view: () =&gt; m(Counter, { state, actions })
});
</pre>
</div>

<ul class="org-ul">
<li><a href="https://mithril.js.org/stream.html">Streams</a> play a key role here</li>
<li>An <code>update</code> is a stream of "patches"</li>
<li>A <code>states</code> stream of states, obtained with <code>scan</code> on the <code>update</code>
stream and applying an "accumulator"</li>
<li>An <code>actions</code> object containing functions which we pass <code>update</code>, so
that those actions trigger state changes. To be explicit, we would
have
<code>increment: (update, amount) =&gt; { update((state) =&gt; ({ count: state.count + amount})}</code>
(but this is clearly overkill with superfluous boilerplate)</li>
</ul>

<p>
For more on SAM in Mithril, see:
</p>

<ul class="org-ul">
<li><a href="https://meiosis.js.org/">https://meiosis.js.org/</a></li>
<li><a href="https://www.lambrospetrou.com/articles/meiosisjs-typescript-mithril-demo/">https://www.lambrospetrou.com/articles/meiosisjs-typescript-mithril-demo/</a></li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-h-81096b07-f043-42aa-91c4-fba28ee7e052" class="outline-2">
<h2 id="h-81096b07-f043-42aa-91c4-fba28ee7e052"><span class="section-number-2">2.</span> References</h2>
<div class="outline-text-2" id="text-h-81096b07-f043-42aa-91c4-fba28ee7e052">
<ul class="org-ul">
<li>James Forbes, <a href="https://james-forbes.com/posts/hooks-and-streams">Hooks and Streams</a></li>
<li>James Adam,
<a href="https://jamesadam.me/2017/03/09/implementing-search-as-you-type-with-mithril-js/">Implementing Search-as-you-type withÂ Mithril.js</a></li>
<li><a href="https://codingconnects.com/sam-pattern">https://codingconnects.com/sam-pattern</a></li>
<li><a href="https://www.infoq.com/articles/sam-lessons-learned-front-end-reactive-architectures/">https://www.infoq.com/articles/sam-lessons-learned-front-end-reactive-architectures/</a></li>
<li>Lisp and Javascript
<ul class="org-ul">
<li><a href="https://github.com/anko/eslisp">https://github.com/anko/eslisp</a></li>
<li><a href="https://wiki.call-cc.org/eggref/5/spock">https://wiki.call-cc.org/eggref/5/spock</a></li>
<li><a href="https://web.archive.org/web/20160608142443/https://lispyscript.com/">https://web.archive.org/web/20160608142443/https://lispyscript.com/</a></li>
<li><a href="https://github.com/santoshrajan/lispyscript/">https://github.com/santoshrajan/lispyscript/</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="postamble">Last Updated 2022-11-20 Sun 18:12.</p>
</div>
</body>
</html>